<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/css/reset.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.css">
    <script src="https://cdn.mxpnl.com/libs/mixpanel-platform/build/mixpanel-platform.v0.latest.min.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="https://d621cde4587c562960fbe230744f42dc2304ca4f.googledrive.com/host/0BxwayM8qQaCVX0w4RExCOVdhbzQ">
    <link rel="stylesheet" type="text/css" href="https://a7fd22d7f1e3c3ec503950ff3eb0ca354866665d.googledrive.com/host/0BxwayM8qQaCVMk14UTA0V2JuSVU">
    <link rel="stylesheet" type="text/css" href="https://5a4961e5c9f1459a1c463234568af125d8e1b386.googledrive.com/host/0BxwayM8qQaCVRmRCSDlXUUtMMnc/">
    <link rel="stylesheet" type="text/css" href="https://201420392a7158f07d53a8f3e71606645ab03bd2.googledrive.com/host/0BxwayM8qQaCVQldvY2U5Um9FN3M">
    <!--
    <link rel="stylesheet" type="text/css" href="app.css">
    <link rel="stylesheet" type="text/css" href="simple-line-icons.css">
    <link rel="stylesheet" type="text/css" href="weather-icons.css">
    <link rel="stylesheet" type="text/css" href="font-awesome.min.css">
    -->
    <script src="//cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
    <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.2.4/css/simple-line-icons.min.css">
    <style>
      
    </style>
  </head>
  <body class="mixpanel-platform-body">
    <div class="mixpanel-platform-section">
      <div class="content-wrapper">
            <div class="content-heading text-center">
               <!-- START Language list-->
               <div class="pull-right" style="bottom: 10px;">
                  <img src="https://d018d7277c9a2a72c253b637c4abe4d24d29449c.googledrive.com/host/0BxwayM8qQaCVOGZvekkxYTNSZVU" height="40px" width="120px">
                  
               </div>
               <div class="pull-left">
                  
                  
               </div>
               <!-- END Language list    -->
               Central Dashboard
               <small data-localize="dashboard.WELCOME"></small>
            </div>
            <!-- START widgets box-->
            <div class="row">
               <div class="col-lg-3 col-sm-3">
                  <!-- START widget-->
                  <div class="panel widget bg-primary">
                     <div class="row row-table">
                        <div class="col-xs-4 text-center bg-primary-dark pv-lg">
                           <em class="icon-speedometer fa-3x"></em>
                        </div>
                        <div class="col-xs-8 pv-lg">
                           <div class="h2 mt0 current-users text-center">0</div>
                           <div class="text-uppercase text-center">New Users</div>
                        </div>
                     </div>
                  </div><!-- end panel widget bg-primary-->
               </div>
               <div class="col-lg-3 col-sm-3">
                  <!-- START widget-->
                  <div class="panel widget bg-purple">
                     <div class="row row-table">
                        <div class="col-xs-4 text-center bg-purple-dark pv-lg">
                            <em class="icon-users fa-3x"></em>
                        </div>
                        <div class="col-xs-8 pv-lg">
                           <div class="h2 mt0 monthly-actives text-center">0
                              <!--<small>GB</small>-->
                           </div>
                           <div class="text-uppercase text-center">MAU'S</div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-3 col-md-6 col-sm-3">
                  <!-- START widget-->
                  <div class="panel widget bg-green">
                     <div class="row row-table">
                        <div class="col-xs-4 text-center bg-green-dark pv-lg">
                           <em class="icon-energy fa-3x"></em>
                        </div>
                        <div class="col-xs-8 pv-lg">
                           <div class="h2 mt0 daily-actives text-center">0</div>
                           <div class="text-uppercase text-center">DAU'S</div>
                        </div>
                     </div>
                  </div>
               </div>
               <div class="col-lg-3 col-md-6 col-sm-3">
                  <!-- START date widget-->
                  <div class="panel widget">
                     <div class="row row-table">
                        <div class="col-xs-4 text-center bg-green pv-lg">
                           <!-- See formats: https://docs.angularjs.org/api/ng/filter/date-->
                           <div data-now="" data-format="MMMM" class="text-sm date-month text-center"></div>
                           <br>
                           <div data-now="" data-format="D" class="h2 mt0 date-day text-center"></div>
                        </div>
                        <div class="col-xs-8 pv-lg">
                           <div data-now="" data-format="dddd" class="text-uppercase date-actual-day text-center"></div>
                           <br>
                           <div data-now="" data-format="h:mm" class="h2 mt0 date-time"></div>
                           <div data-now="" data-format="a" class="text-muted text-sm date-pm"></div>
                        </div>
                     </div>
                  </div>
                  <!-- END date widget    -->
               </div>
            </div>

      <div style="clear: both;"></div>
      <div class="actives">
        <div style="padding-top: 20px; padding-bottom: 20px"  id="weeklyActiveUsers"></div>
        <div style="padding-top: 20px; padding-bottom: 20px" id="monthlyActiveUsers"></div>
      </div>
      <div class="newUsers">
        <div style="padding-top: 20px; padding-bottom: 20px"  id="weeklyNewUsers"></div>
        <div style="padding-top: 20px; padding-bottom: 20px" id="monthlyNewUsers"></div>
      </div>
      <div class="newUsersOverActiveUsers">
        <div style="padding-top: 20px; padding-bottom: 20px"  id="weeklyActiveAndNewPercentage"></div>
        <div style="padding-top: 20px; padding-bottom: 20px" id="MonthlyActiveAndNewPercentage"></div>
      </div>
      <div class="DAUsMAUs">
        <div style="padding-top: 20px; padding-bottom: 20px" id="dau-over-mau-graph"></div>
        <div style="padding-top: 20px; padding-bottom: 20px" id="dau-over-mau-graph-2"></div>
      </div>
      <div id="graph" style="padding-top: 20px; padding-bottom: 20px"></div>
      
    </div>
    <div id="table"> </div>

    <script id="cq-new-users-today">
      var today = Math.round(new Date().getTime())
      var paramsToday = new Date().toISOString().split('T')[0]
      params = {
        "startDate": '2012-01-01',
        "endDate": paramsToday
      }
      function main(){
        return Events({
          from_date: params.startDate, 
          to_date: params.endDate
        })
        .groupByUser(function(state, event){
          if (state === undefined){
            state = {eventTime: today} 
          }
          _.each(event, function(e) {
            if (e.time < state.eventTime) {
              state.eventTime =  e.time;
            }
          });
          return state
        })
        .groupBy([function(collection){
          var stringDate = new Date(collection.value.eventTime).toISOString().split('T')[0]
          if(stringDate === paramsToday){
              return stringDate
          }
        }], mixpanel.reducer.count())
        
        };
    </script>
    <script id="cq-weekly-new-users">
      var today = Math.round(new Date().getTime())

      var date = new Date().toISOString().split('T')[0]
      var a = new Date();
      a.setDate(a.getDate() - 84);
      var twelveWeeks = new Date(a).toISOString().split('T')[0]
      params = {
        "startDate":twelveWeeks,
        "endDate": date
      }
      function main(){
        return Events({
          from_date: params.startDate, 
          to_date: params.endDate
        })
        .groupByUser(function(state, event){
          if (state === undefined){
            state = {eventTime: today} 
          }
          _.each(event, function(e) {
            if (e.time < state.eventTime) {
              state.eventTime =  e.time;
            }
          });
          return state
        })
        .groupBy([function(collection){
          var time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          var firstWeek = time.getDate() - time.getDay() + 1; // First day is the day of the month - the day of the week, monday being the first day in the week
          var thisWeek = time.setDate(firstWeek)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var twoWeeksAgo = time.setDate(firstWeek-7)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var threeWeeksAgo = time.setDate(firstWeek-14)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var fourWeeksAgo = time.setDate(firstWeek-21)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var fiveWeeksAgo = time.setDate(firstWeek-28)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var sixWeeksAgo = time.setDate(firstWeek-35)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var sevenWeeksAgo = time.setDate(firstWeek-42)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var eightWeeksAgo = time.setDate(firstWeek-49)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var nineWeeksAgo = time.setDate(firstWeek-56)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var tenWeeksAgo = time.setDate(firstWeek-63)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          var elevenWeeksAgo = time.setDate(firstWeek-70)
          time = new Date().setHours(0,0,0,0);
          time = new Date(time)
          firstWeek = time.getDate() - time.getDay() + 1
          twelveWeeksAgo = time.setDate(firstWeek-77)
          
          if (collection.value.eventTime > thisWeek){
            var thisWeekResult =  new Date(thisWeek).toISOString().split('T')[0]
            thisWeekResult = thisWeekResult.split("-")
            thisWeekResult = thisWeekResult[1] + "-" + thisWeekResult[2]
            return thisWeekResult
          }else if(collection.value.eventTime < thisWeek && collection.value.eventTime > twoWeeksAgo){
            var twoWeeksAgoResult = new Date(twoWeeksAgo).toISOString().split('T')[0]
            twoWeeksAgoResult = twoWeeksAgoResult.split("-")
            twoWeeksAgoResult = twoWeeksAgoResult[1] + "-" + twoWeeksAgoResult[2]
            return twoWeeksAgoResult
          }else if(collection.value.eventTime < twoWeeksAgo && collection.value.eventTime > threeWeeksAgo){
            var threeWeeksAgoResult = new Date(threeWeeksAgo).toISOString().split('T')[0]
            threeWeeksAgoResult = threeWeeksAgoResult.split("-")
            threeWeeksAgoResult = threeWeeksAgoResult[1] + "-" + threeWeeksAgoResult[2]
            return threeWeeksAgoResult
          }else if(collection.value.eventTime < threeWeeksAgo && collection.value.eventTime > fourWeeksAgo) {
            var fourWeeksAgoResult = new Date(fourWeeksAgo).toISOString().split('T')[0]
            fourWeeksAgoResult = fourWeeksAgoResult.split("-")
            fourWeeksAgoResult = fourWeeksAgoResult[1] + "-" + fourWeeksAgoResult[2]
            return fourWeeksAgoResult
          }else if(collection.value.eventTime < fourWeeksAgo && collection.value.eventTime > fiveWeeksAgo){
            var fiveWeeksAgoResult = new Date(fiveWeeksAgo).toISOString().split('T')[0]
            fiveWeeksAgoResult = fiveWeeksAgoResult.split("-")
            fiveWeeksAgoResult = fiveWeeksAgoResult[1] + "-" + fiveWeeksAgoResult[2]
            return fiveWeeksAgoResult
          }else if(collection.value.eventTime < fiveWeeksAgo && collection.value.eventTime > sixWeeksAgo){
            var sixWeeksAgoResult = new Date(sixWeeksAgo).toISOString().split('T')[0]
            sixWeeksAgoResult = sixWeeksAgoResult.split("-")
            sixWeeksAgoResult = sixWeeksAgoResult[1] + "-" + sixWeeksAgoResult[2]
            return sixWeeksAgoResult
          }else if(collection.value.eventTime < sixWeeksAgo && collection.value.eventTime > sevenWeeksAgo){
            var sevenWeeksAgoResult = new Date(sevenWeeksAgo).toISOString().split('T')[0]
            sevenWeeksAgoResult = sevenWeeksAgoResult.split("-")
            sevenWeeksAgoResult = sevenWeeksAgoResult[1] + "-" + sevenWeeksAgoResult[2]
            return sevenWeeksAgoResult
          }else if(collection.value.eventTime < sevenWeeksAgo && collection.value.eventTime > eightWeeksAgo){
            var eightWeeksAgoResult = new Date(eightWeeksAgo).toISOString().split('T')[0]
            eightWeeksAgoResult = eightWeeksAgoResult.split("-")
            eightWeeksAgoResult = eightWeeksAgoResult[1] + "-" + eightWeeksAgoResult[2]
            return eightWeeksAgoResult
          }else if(collection.value.eventTime < eightWeeksAgo && collection.value.eventTime > nineWeeksAgo){
            var nineWeeksAgoResult = new Date(nineWeeksAgo).toISOString().split('T')[0]
            nineWeeksAgoResult = nineWeeksAgoResult.split("-")
            nineWeeksAgoResult = nineWeeksAgoResult[1] + "-" + nineWeeksAgoResult[2]
            return nineWeeksAgoResult
          }else if(collection.value.eventTime < nineWeeksAgo && collection.value.eventTime > tenWeeksAgo){
            var tenWeeksAgoResult = new Date(tenWeeksAgo).toISOString().split('T')[0]
            tenWeeksAgoResult = tenWeeksAgoResult.split("-")
            tenWeeksAgoResult = tenWeeksAgoResult[1] + "-" + tenWeeksAgoResult[2]
            return tenWeeksAgoResult
          }else if(collection.value.eventTime < tenWeeksAgo && collection.value.eventTime > elevenWeeksAgo){
            var elevenWeeksAgoResult = new Date(elevenWeeksAgo).toISOString().split('T')[0]
            elevenWeeksAgoResult = elevenWeeksAgoResult.split("-")
            elevenWeeksAgoResult = elevenWeeksAgoResult[1] + "-" + elevenWeeksAgoResult[2]
            return elevenWeeksAgoResult
          }else if (collection.value.eventTime < elevenWeeksAgo && collection.value.eventTime > twelveWeeksAgo){
             var twelveWeeksAgoResult = new Date(twelveWeeksAgo).toISOString().split('T')[0]
            twelveWeeksAgoResult = twelveWeeksAgoResult.split("-")
            twelveWeeksAgoResult = twelveWeeksAgoResult[1] + "-" + twelveWeeksAgoResult[2]
            return twelveWeeksAgoResult
          }else{}
          
        }], mixpanel.reducer.count())
        
        };
    </script>
    <script id="cq-monthly-new-users">
      var today = Math.round(new Date().getTime())
      var date = new Date().toISOString().split('T')[0]

      var a = new Date();
      var sixMonths = new Date(a.getFullYear(), a.getMonth()-5, 1).toISOString().split('T')[0];

      params = {
        "startDate":sixMonths,
        "endDate": date
      }
      function main(){
        return Events({
          from_date: params.startDate, 
          to_date: params.endDate
        })
        .groupByUser(function(state, event){
          if (state === undefined){
            state = {eventTime: today} 
          }
          _.each(event, function(e) {
            if (e.time < state.eventTime) {
              state.eventTime =  e.time;
            }
          });
          return state
        })
        .groupBy([function(collection){
          var year = new Date(collection.value.eventTime).toISOString().split('T')[0].split('-')[0]
          var month = new Date(collection.value.eventTime).toISOString().split('T')[0].split('-')[1]
          var yearMonth = year + "-" + month
          return yearMonth
        }], mixpanel.reducer.count())
        
      };
    </script>
    <script>
      //setting some global variables
      //weekly active(uniques) and weekly new users
      var xAxisWeeklyActive = []
      var yAxisWeeklyActive = []
      var weeklyNewUseryAxis = []
      var weeklyNewUserxAxis = []
      
      //monthly active(uniques) and monthly new Users
      var monthlActivesXAxis = []
      var monthlyActivesYAxis = []
      var monthlyNewUserxAxis =[]
      var monthlyNewUserData =[]

      var outputArrayWeekly =[]
      var outputArrayMonthly =[]
      //end of global variables


      //set credentials for local development
      
      
      //formatting for numbers
      function addCommas(intNum) {
          return (intNum + '').replace(/(\d)(?=(\d{3})+$)/g, '$1,');
        }
      var newUsersToday = function(){
        var newUsersTodayScript = $('#cq-new-users-today').html();
        newUsersTodayScript = $.trim(newUsersTodayScript);
  
        MP.api.custom_query(newUsersTodayScript).done(function(results) {
         console.log(results)
          if (results[0].key[0] === null) {
            $('.current-users').text(addCommas(results[1].value));
          }else{$('.current-users').text(0)}

        })
      }
      var weeklyNewUsersQuery =  function(){
        //weekly new users query
        var newWeeklyNewUserScript = $('#cq-weekly-new-users').html();
        newWeeklyNewUserScript = $.trim(newWeeklyNewUserScript);
  
        MP.api.custom_query(newWeeklyNewUserScript).done(function(results) {
          
          
          var weeklyNewUserxAxis =[]
          $.each(results, function(index, value){
            if(value.key[0] !== null){
            weeklyNewUserxAxis.push(value.key[0])
            }
          })
          //console.log(monthlyNewUserxAxis)
          var weeklyNewUseryAxis =[]
          $.each(results, function(index, value){
            if(value.key[0] !== null){
              weeklyNewUseryAxis.push(value.value)
            }
          })

          
          

          $('#weeklyNewUsers').highcharts({
                    title: {
                        text: 'New User Per Week:'
                    },
                    
                    xAxis: {
                        categories: weeklyNewUserxAxis
                    },
                    yAxis: {
                      title: {
                          text: 'New Users'
                      }
                    },
                    series: [{
                        type: 'spline',
                        name: 'Weekly New Users',
                        data: weeklyNewUseryAxis
                    }],
                     exporting: {
                      enabled: true
                    },
                });

        })
      }
      var monthlyNewUsersQuery =  function(){
        //weekly new users query
        var newMonthlyNewUserScript = $('#cq-monthly-new-users').html();
        newMonthlyNewUserScript = $.trim(newMonthlyNewUserScript);
    
        MP.api.custom_query(newMonthlyNewUserScript).done(function(results) {
          //console.log(results)
         
          $.each(results, function(index, value){
            monthlyNewUserxAxis.push(value.key[0])
          })
          //console.log(monthlyNewUserxAxis)
         
          $.each(results, function(index, value){
            monthlyNewUserData.push(value.value)
          })
          console.log(monthlyNewUserData)


          $('#monthlyNewUsers').highcharts({
                    title: {
                        text: 'New User Per Month'
                    },
                    xAxis: {
                        categories: monthlyNewUserxAxis
                    },
                    yAxis: {
                      title: {
                          text: 'New Users'
                      }
                    },
                    series: [{
                        type: 'spline',
                        name: 'Monthly New Users',
                        data: monthlyNewUserData
                    }],
                     exporting: {
                      enabled: true
                    },
          });

        })
      }
      //function for top events and event count
      var topEventsQuery = function() {
        // params for top events
        var params = {
          type: 'general',
          limit: 10
        }
        MP.api.topEvents(params).done(function(results) {
              
              var eventsArray = results.values()
              params = {
                type:'general',
                unit:'month',
                interval: 6
              }

              MP.api.events(eventsArray[0],eventsArray[1],eventsArray[2],eventsArray[3],eventsArray[4],eventsArray[5],eventsArray[6],eventsArray[7],eventsArray[8],eventsArray[9], params).done(function(results){
                var graphData = {}
                var xAxis = [] 
                var objectArray = new Array()
                //console.log('got results top /n', results.json);
                var dataObject = results.json
                
                $.each(results.json, function (index, value) {
                  if(eventsArray[0] == index){
                    $.each(value, function (index,value) {
                      //console.log(index)
                       xAxis.push(index)
                      graphData[index] = []
                    })
                  }
                });
                //loop through results.json match date to date key in graphData
                $.each(results.json, function (index, value) {              
                  for (i = 0; i < 9; i++){
                    objectArray =[]
                    //when matched take the event name, set as key, set value pair as event count
                    if(eventsArray[i] === index){
                      //for each function to grab the event objects key
                      $.each(value, function (index,value) {
                        //console.log(index)
                        //loop through the graphdata (object we want to set on our graph) object and pull out date keys
                        
                        $.each(graphData, function(graphindex, graphvalue){
                          // if date keys in graphdata (grpahindex value) mataches the date key in the events object add the event with it's event count for that month to the date key
                          if (index === graphindex) { 
                            var stuff = {}
                            stuff[eventsArray[i]] = parseFloat(value)
                            graphData[index].push(stuff)   
                          }                          
                        })
                      })
                    }
                  }
                })


                sortedxAxis = xAxis.sort()
    
                //math for average line

                var month1 = parseInt((dataObject[eventsArray[0]][sortedxAxis[0]]+dataObject[eventsArray[1]][sortedxAxis[0]]+dataObject[eventsArray[2]][sortedxAxis[0]]+dataObject[eventsArray[3]][sortedxAxis[0]]+dataObject[eventsArray[4]][sortedxAxis[0]]+dataObject[eventsArray[5]][sortedxAxis[0]])/6)

                var month2 = parseInt((dataObject[eventsArray[0]][sortedxAxis[1]]+dataObject[eventsArray[1]][sortedxAxis[1]]+dataObject[eventsArray[2]][sortedxAxis[1]]+dataObject[eventsArray[3]][sortedxAxis[1]]+dataObject[eventsArray[4]][sortedxAxis[1]]+dataObject[eventsArray[5]][sortedxAxis[1]])/6)

                var month3 = parseInt((dataObject[eventsArray[0]][sortedxAxis[2]]+dataObject[eventsArray[1]][sortedxAxis[2]]+dataObject[eventsArray[2]][sortedxAxis[2]]+dataObject[eventsArray[3]][sortedxAxis[2]]+dataObject[eventsArray[4]][sortedxAxis[2]]+dataObject[eventsArray[5]][sortedxAxis[2]])/6)

                var month4 = parseInt((dataObject[eventsArray[0]][sortedxAxis[3]]+dataObject[eventsArray[1]][sortedxAxis[0]]+dataObject[eventsArray[2]][sortedxAxis[3]]+dataObject[eventsArray[3]][sortedxAxis[3]]+dataObject[eventsArray[4]][sortedxAxis[3]]+dataObject[eventsArray[5]][sortedxAxis[3]])/6)

                var month5 = parseInt((dataObject[eventsArray[0]][sortedxAxis[4]]+dataObject[eventsArray[1]][sortedxAxis[4]]+dataObject[eventsArray[2]][sortedxAxis[4]]+dataObject[eventsArray[3]][sortedxAxis[4]]+dataObject[eventsArray[4]][sortedxAxis[4]]+dataObject[eventsArray[5]][sortedxAxis[4]])/6)

                var month6 = parseInt((dataObject[eventsArray[0]][sortedxAxis[5]]+dataObject[eventsArray[1]][sortedxAxis[5]]+dataObject[eventsArray[2]][sortedxAxis[5]]+dataObject[eventsArray[3]][sortedxAxis[5]]+dataObject[eventsArray[4]][sortedxAxis[5]]+dataObject[eventsArray[5]][sortedxAxis[5]])/6)
                //console.log(month1)
                
                  $('#graph').highcharts({
                    title: {
                        text: 'Top Events Over the Last 6 Months: Total Event Counts'
                    },
                    xAxis: {
                        categories: sortedxAxis
                    },
                    labels: {
                        items: [{
                            html: 'Total Event Count For Top Events: Last 6 Months',
                            style: {
                                left: '50px',
                                top: '18px',
                                color: (Highcharts.theme && Highcharts.theme.textColor) || 'black'
                            }
                        }]
                    },
                    series: [{
                        type: 'column',
                        name: eventsArray[0],
                        data: [dataObject[eventsArray[0]][sortedxAxis[0]],dataObject[eventsArray[0]][sortedxAxis[1]],dataObject[eventsArray[0]][sortedxAxis[2]],dataObject[eventsArray[0]][sortedxAxis[3]],dataObject[eventsArray[0]][sortedxAxis[4]],dataObject[eventsArray[0]][sortedxAxis[5]]]
                    }, {
                        type: 'column',
                        name: eventsArray[1],
                        data: [dataObject[eventsArray[1]][sortedxAxis[0]],dataObject[eventsArray[1]][sortedxAxis[1]],dataObject[eventsArray[1]][sortedxAxis[2]],dataObject[eventsArray[1]][sortedxAxis[3]],dataObject[eventsArray[1]][sortedxAxis[4]],dataObject[eventsArray[1]][sortedxAxis[5]]]
                    }, {
                        type: 'column',
                        name: eventsArray[2],
                        data: [dataObject[eventsArray[2]][sortedxAxis[0]],dataObject[eventsArray[2]][sortedxAxis[1]],dataObject[eventsArray[2]][sortedxAxis[2]],dataObject[eventsArray[2]][sortedxAxis[3]],dataObject[eventsArray[2]][sortedxAxis[4]],dataObject[eventsArray[2]][sortedxAxis[5]]]
                    },{
                        type: 'column',
                        name: eventsArray[3],
                        data: [dataObject[eventsArray[3]][sortedxAxis[0]],dataObject[eventsArray[3]][sortedxAxis[1]],dataObject[eventsArray[3]][sortedxAxis[2]],dataObject[eventsArray[3]][sortedxAxis[3]],dataObject[eventsArray[3]][sortedxAxis[4]],dataObject[eventsArray[3]][sortedxAxis[5]]]
                    }, {
                        type: 'column',
                        name: eventsArray[4],
                        data: [dataObject[eventsArray[4]][sortedxAxis[0]],dataObject[eventsArray[4]][sortedxAxis[1]],dataObject[eventsArray[4]][sortedxAxis[2]],dataObject[eventsArray[4]][sortedxAxis[3]],dataObject[eventsArray[4]][sortedxAxis[4]],dataObject[eventsArray[4]][sortedxAxis[5]]]
                    }, {
                        type: 'column',
                        name: eventsArray[5],
                        data: [dataObject[eventsArray[5]][sortedxAxis[0]],dataObject[eventsArray[5]][sortedxAxis[1]],dataObject[eventsArray[5]][sortedxAxis[2]],dataObject[eventsArray[5]][sortedxAxis[3]],dataObject[eventsArray[5]][sortedxAxis[4]],dataObject[eventsArray[5]][sortedxAxis[5]]]
                    }, {
                        type: 'spline',
                        name: 'Combined Events Average Per Month',
                        data: [month1,month2,month3,month4,month5,month6],
                        marker: {
                            lineWidth: 2,
                            lineColor: Highcharts.getOptions().colors[3],
                            fillColor: 'white'
                        }
                    },
                    {
                        type: 'pie',
                        name: 'Total Event Count Last 6 Months',
                        data: [{
                            name: eventsArray[0],
                            y: dataObject[eventsArray[0]][sortedxAxis[0]]+dataObject[eventsArray[0]][sortedxAxis[1]]+dataObject[eventsArray[0]][sortedxAxis[2]]+dataObject[eventsArray[0]][sortedxAxis[3]]+dataObject[eventsArray[0]][sortedxAxis[4]]+dataObject[eventsArray[0]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[0] // Jane's color
                        }, {
                            name: eventsArray[1],
                            y: dataObject[eventsArray[1]][sortedxAxis[0]]+dataObject[eventsArray[1]][sortedxAxis[1]]+dataObject[eventsArray[1]][sortedxAxis[2]]+dataObject[eventsArray[1]][sortedxAxis[3]]+dataObject[eventsArray[1]][sortedxAxis[4]]+dataObject[eventsArray[1]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[1] // John's color
                        }, {
                            name: eventsArray[2],
                            y: dataObject[eventsArray[2]][sortedxAxis[0]]+dataObject[eventsArray[2]][sortedxAxis[1]]+dataObject[eventsArray[2]][sortedxAxis[2]]+dataObject[eventsArray[2]][sortedxAxis[3]]+dataObject[eventsArray[2]][sortedxAxis[4]]+dataObject[eventsArray[2]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[2] // Joe's color
                        },{
                            name: eventsArray[3],
                            y: dataObject[eventsArray[3]][sortedxAxis[0]]+dataObject[eventsArray[3]][sortedxAxis[1]]+dataObject[eventsArray[3]][sortedxAxis[2]]+dataObject[eventsArray[3]][sortedxAxis[3]]+dataObject[eventsArray[3]][sortedxAxis[4]]+dataObject[eventsArray[3]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[3] // Joe's color
                        },{
                            name: eventsArray[4],
                            y: dataObject[eventsArray[4]][sortedxAxis[0]]+dataObject[eventsArray[4]][sortedxAxis[1]]+dataObject[eventsArray[4]][sortedxAxis[2]]+dataObject[eventsArray[4]][sortedxAxis[3]]+dataObject[eventsArray[4]][sortedxAxis[4]]+dataObject[eventsArray[4]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[4] // Joe's color
                        },{
                            name: eventsArray[5],
                            y: dataObject[eventsArray[5]][sortedxAxis[0]]+dataObject[eventsArray[5]][sortedxAxis[1]]+dataObject[eventsArray[5]][sortedxAxis[2]]+dataObject[eventsArray[5]][sortedxAxis[3]]+dataObject[eventsArray[5]][sortedxAxis[4]]+dataObject[eventsArray[5]][sortedxAxis[5]],
                            color: Highcharts.getOptions().colors[5] // Joe's color
                        }],
                        center: [100, 80],
                        size: 60,
                        showInLegend: false,
                        dataLabels: {
                            enabled: false
                        }
                    }],
                     exporting: {
                      enabled: true
                    },
                     navigation: {
                      buttonOptions: {
                        align: 'right'
                        }
                    }
                  });
              });            
        });
      }
      var topbarQuery = function(){
        /* Get top events */
        events = [];
        MP.api.topEvents().done(function(results) {
          _.each(_.values(results.values()), function(value){
              events.push(value);
          })
          var monthlyQuery = MP.api.query('/api/2.0/events/', {event:events, unit: 'month', union: 1, type:'unique'}, {dataType: 'json'}) 
          monthlyQuery.done(function(json){
              //console.log(json)
              var data = _.values(json.data.values)
              var monthlyActives = _.values(data[0])[0]
    

              $('.monthly-actives').text(addCommas(monthlyActives));
          })  
          /* Query for daily Active Users */
          var dailyQuery = MP.api.query('/api/2.0/events/', {event:events, unit: 'day', union: 1, interval:1, type:'unique'}, {dataType: 'json'});
          dailyQuery.done(function(json){
              var data = _.values(json.data.values)[0];
              var dataKeys = _.keys(data).sort().reverse()
              var dailyActives = data[dataKeys[0]];
              //console.log(dailyActives);
              $('.daily-actives').text(addCommas(dailyActives));
          })
          /* Date Refresh */
          var date = new Date();
          var day = date.getDate()
          var hours = date.getHours();
          var convertedHours = hours <= 12 ? hours : hours - 12;
          var ampm = hours >= 12 ? 'pm' : 'am';
          var time = convertedHours.toString() + ':' + pad(date.getMinutes()).toString();
          var month = getCurrentMonth();
          var actualDay = getCurrentDay();
          $('.date-month').text(month);
          $('.date-actual-day').text(actualDay);
          $('.date-day').text(day.toString());
          $('.date-time').text(time);
          $('.date-pm').text(ampm);      
        })
      }
      var monthlyQuery = function(){
          events = [];
          MP.api.topEvents().done(function(results) {
            _.each(_.values(results.values()), function(value){
              events.push(value);
            })
            var placeholderObject = {}
            var placeholderArray = []
            var monthlyUniquesYAxis =[]
            var monthlyUniquesXAxis =[]
            // 6 month query for Uniques 
            var monthlyUnqiuesFunction = MP.api.query('/api/2.0/events/', {event:events, from:moment().subtract(5, 'months').startOf('month'), to:moment(), unit: 'month', union: 1, type:'unique'}, {dataType: 'json'})
            monthlyUnqiuesFunction.done(function(json){
              $.each(json.data.values, function(index, values){
                monthlyUniquesYAxis.push(values)
              })
            
              monthlyUniquesXAxis = [json.data.series[0].substring(0,7),json.data.series[1].substring(0,7),json.data.series[2].substring(0,7),json.data.series[3].substring(0,7),json.data.series[4].substring(0,7),json.data.series[5].substring(0,7)]
              monthlyUniquesYAxis = [monthlyUniquesYAxis[0][json.data.series[0]],monthlyUniquesYAxis[0][json.data.series[1]],monthlyUniquesYAxis[0][json.data.series[2]],monthlyUniquesYAxis[0][json.data.series[3]],monthlyUniquesYAxis[0][json.data.series[4]],monthlyUniquesYAxis[0][json.data.series[5]]]
              $('#monthlyActiveUsers').highcharts({
                title: {
                    text: 'Monthly Active Users'
                },
                xAxis: {
                    categories: monthlyUniquesXAxis
                },
                yAxis: {
                  title: {
                      text: 'Active Users'
                  }
                },
                series: [{
                    type: 'spline',
                    name: 'Monthly Acitive Users',
                    data: monthlyUniquesYAxis
                }],
                 exporting: {
                  enabled: true
                },
              });
                var monthlyNewUserxAxis = []
                var monthlyNewUserData2 =[]
                var newMonthlyNewUserScript = $('#cq-monthly-new-users').html();
                newMonthlyNewUserScript = $.trim(newMonthlyNewUserScript);

                MP.api.custom_query(newMonthlyNewUserScript).done(function(results) {
                  $.each(results, function(index, value){
                    monthlyNewUserxAxis.push(value.key[0])
                  })
                  $.each(results, function(index, value){
                    monthlyNewUserData2.push(value.value)
                  })
                  console.log(monthlyNewUserData2)
                  for (var i = 0; i < monthlyNewUserData2.length; i++) {
                    var newPromise = new Promise(function(resolve, reject) {
                      output = parseFloat(monthlyNewUserData2[i]/monthlyUniquesYAxis[i]).toFixed(2)
                      resolve(output)
                    })

                      outputArrayMonthly.push(newPromise)
                  }
                  Promise.all(outputArrayMonthly).then(function(data) {
                      _.each(data, function(value, i) {
                        value = parseFloat(value);
                        data[i] = value;
                      })
                          
                    console.log(data)
                    $('#MonthlyActiveAndNewPercentage').highcharts({
                            title: {
                                text: '% New Monthly Users to Monthly Active User'
                            },
                            
                            xAxis: {
                                categories: monthlyNewUserxAxis
                            },
                            yAxis: {
                              title: {
                                  text: 'Ratio'
                              }
                            },
                            series: [{
                                type: 'spline',
                                name: '% New Monthly Users to Monthly Active User',
                                data: data
                            }],
                             exporting: {
                              enabled: true
                            },
                    });
                  })
                })

            })
          })
      }
      var weeklyQuery = function(){
        events = [];
        MP.api.topEvents().done(function(results) {
          _.each(_.values(results.values()), function(value){
            events.push(value);
          })
          var weeklyUniquesYAxisPlaceholder =[]
          var weeklyUniquesYAxis =[]
          var weeklyUniquesXAxis =[]
          // 12 week query for Uniques 
          var weeklyUnqiuesFunction = MP.api.query('/api/2.0/events/', {event:events, from:moment().subtract(11, 'weeks').startOf('week').add(1, 'day'), to:moment(), unit: 'week', union: 1, type:'unique'}, {dataType: 'json'})
          weeklyUnqiuesFunction.done(function(json){

            $.each(json.data.values, function(index, values){
              weeklyUniquesYAxisPlaceholder.push(values)
            })
            
            weeklyUniquesYAxis = [weeklyUniquesYAxisPlaceholder[0][json.data.series[0]],weeklyUniquesYAxisPlaceholder[0][json.data.series[1]],weeklyUniquesYAxisPlaceholder[0][json.data.series[2]],weeklyUniquesYAxisPlaceholder[0][json.data.series[3]],weeklyUniquesYAxisPlaceholder[0][json.data.series[4]],weeklyUniquesYAxisPlaceholder[0][json.data.series[5]],weeklyUniquesYAxisPlaceholder[0][json.data.series[6]],weeklyUniquesYAxisPlaceholder[0][json.data.series[7]],weeklyUniquesYAxisPlaceholder[0][json.data.series[8]],weeklyUniquesYAxisPlaceholder[0][json.data.series[9]],weeklyUniquesYAxisPlaceholder[0][json.data.series[10]],weeklyUniquesYAxisPlaceholder[0][json.data.series[11]]]
            weeklyUniquesXAxis = [json.data.series[0].substring(5,9),json.data.series[1].substring(5,9),json.data.series[2].substring(5,9),json.data.series[3].substring(5,9),json.data.series[4].substring(5,9),json.data.series[5].substring(5,9),json.data.series[6].substring(5,9),json.data.series[7].substring(5,9),json.data.series[8].substring(5,9),json.data.series[9].substring(5,9),json.data.series[10].substring(5,9),json.data.series[11].substring(5,9)]

            $('#weeklyActiveUsers').highcharts({
              title: {
                  text: 'Weekly Active Users'
              },
              xAxis: {
                  categories: weeklyUniquesXAxis
              },
              yAxis: {
                title: {
                    text: 'Active Users'
                }
              },
              series: [{
                  type: 'spline',
                  name: 'Weekly Acitive Users',
                  data: weeklyUniquesYAxis
              }],
               exporting: {
                enabled: true
              },
            });
                var weeklyNewUserxAxis = []
                var weeklyNewUserData2 =[]
                var outputArrayWeekly = []
                var output = 0
                
                var newWeeklyNewUserScript = $('#cq-weekly-new-users').html();
                newWeeklyNewUserScript = $.trim(newWeeklyNewUserScript);

                MP.api.custom_query(newWeeklyNewUserScript).done(function(results) {
                    $.each(results, function(index, value){
                      if(value.key[0] !== null){
                        weeklyNewUserxAxis.push(value.key[0])
                      }
                    })
                    $.each(results, function(index, value){
                      if(value.key[0] !== null){
                        weeklyNewUserData2.push(value.value)
                      }
                    })
                  for (var i = 0; i < weeklyNewUserData2.length; i++) {
                    var newPromise = new Promise(function(resolve, reject) {
                      output = parseFloat(weeklyNewUserData2[i]/weeklyUniquesYAxis[i]).toFixed(2)
                      resolve(output)
                    })
                    outputArrayWeekly.push(newPromise)
                  }
                  Promise.all(outputArrayWeekly).then(function(data) {
                      _.each(data, function(value, i) {
                        value = parseFloat(value);
                        data[i] = value;
                      })  
                      $('#weeklyActiveAndNewPercentage').highcharts({
                              title: {
                                  text: '% New Weekly Users to Weekly Active User'
                              },
                              
                              xAxis: {
                                  categories: weeklyNewUserxAxis
                              },
                              yAxis: {
                                title: {
                                    text: 'Ratio'
                                }
                              },
                              series: [{
                                  type: 'spline',
                                  name: '% New Weekly Users to Weekly Active User',
                                  data: data
                              }],
                               exporting: {
                                enabled: true
                              },
                      });
                  })
                })
          })
        })
      }
      var dauOverMausQueryLastMonth = function() {
        events = [];
        MP.api.topEvents().done(function(results) {
          _.each(_.values(results.values()), function(value){
            events.push(value);
          })
          // Uniques for this month
          var lastMonthUniques = []
          var lastMonthForMauOverDAU = MP.api.query('/api/2.0/events/', {event:events, from:moment().subtract(1,'month').startOf('month'), to:moment().subtract(1,'month').endOf('month'), unit: 'month', union: 1, type:'unique'}, {dataType: 'json'})
          lastMonthForMauOverDAU.done(function(json){
            $.each(json.data.values, function(index, values){
              $.each(values, function(index, values){
                lastMonthUniques.push(values)
              })
            })
            console.log(lastMonthUniques)
          })
          //Uniques for this month by day
          var lastMonthUniquesbyDayQueryResults = []
          var thisMonthUniquesbyDayArray = []
          var weekOneArray = []
          var weekTwoArray = []
          var weekThreeArray = []
          var weekFourArray = []
          var weekFiveArray = []
          
          var dailyForMauOverDAULastMonth = MP.api.query('/api/2.0/events/', {event:events, from:moment().subtract(1,'month').startOf('month'), to:moment().subtract(1,'month').endOf('month'), unit: 'day', union: 1, type:'unique'}, {dataType: 'json'})
          dailyForMauOverDAULastMonth.done(function(json){
            console.log(json)
            $.each(json.data.values, function (index, values) {
              lastMonthUniquesbyDayQueryResults.push(values)
            })
            console.log(json.data.series.length)
            // math to calculate dau/mau for each day
            for (var i = 0; i < json.data.series.length; i++) {
              if(i <= 6){
                weekOneArray.push(parseFloat((lastMonthUniquesbyDayQueryResults[0][json.data.series[i]]/lastMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 7 && i <= 13){
                weekTwoArray.push(parseFloat((lastMonthUniquesbyDayQueryResults[0][json.data.series[i]]/lastMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 14 && i <= 20){
                weekThreeArray.push(parseFloat((lastMonthUniquesbyDayQueryResults[0][json.data.series[i]]/lastMonthUniques[0]).toFixed(3)*100))
              }else if (i >= 21 && i <= 27) {
                weekFourArray.push(parseFloat((lastMonthUniquesbyDayQueryResults[0][json.data.series[i]]/lastMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 28 && i <= 31){
                weekFiveArray.push(parseFloat((lastMonthUniquesbyDayQueryResults[0][json.data.series[i]]/lastMonthUniques[0]).toFixed(3)*100))
              }else{}
            }
            console.log(lastMonthUniquesbyDayQueryResults)
            console.log(weekOneArray.length)
            console.log(weekOneArray)
            console.log(weekTwoArray.length)
            console.log(weekTwoArray)
            console.log(weekThreeArray.length)
            console.log(weekThreeArray)
            console.log(weekFourArray.length)
            console.log(weekFourArray)

            $('#dau-over-mau-graph').highcharts({
            title: {
                text: 'DAU\'s over MAU\'s Last Month'
            },
            xAxis: {
                categories: ["Day 1", "Day 2", "Day 3","Day 4", "Day 5", "Day 6", "Day 7"]
            },
            yAxis: {
              title: {
                  text: '% DAU over MAU'
              }
            },
            series: [{
                type: 'spline',
                name: 'Week One DAU\'s MAU\'s',
                data: weekOneArray
            },{
                type: 'spline',
                name: 'Week Two DAU\'s MAU\'s',
                data: weekTwoArray
            },{
                type: 'spline',
                name: 'Week Three DAU\'s MAU\'s',
                data: weekThreeArray
            },{
                type: 'spline',
                name: 'Week Four DAU\'s MAU\'s',
                data: weekFourArray
            },{
                type: 'spline',
                name: 'Week Five DAU\'s MAU\'s',
                data: weekFiveArray
            }],
            legend: {
            align: 'center',
            },
            exporting: {
              enabled: true
              },
          });
          })
          
        })  
      }
      var dauOverMausQueryThisMonth = function() {
        events = [];
        MP.api.topEvents().done(function(results) {
          _.each(_.values(results.values()), function(value){
            events.push(value);
          })
          // Uniques for this month
          var thisMonthUniques = []
          var monthlyForMauOverDAU = MP.api.query('/api/2.0/events/', {event:events, from:moment().subtract(1,'month').startOf('month'), to:moment().subtract(1,'month').endOf('month'), unit: 'month', union: 1, type:'unique'}, {dataType: 'json'})
          monthlyForMauOverDAU.done(function(json){
            $.each(json.data.values, function(index, values){
              $.each(values, function(index, values){
                thisMonthUniques.push(values)
              })
            })
            console.log(thisMonthUniques)
          })
          //Uniques for this month by day
          var thisMonthUniquesbyDayQueryResults = []
          var thisMonthUniquesbyDayArray = []
          var thisMonthweekOneArray = []
          var thisMonthweekTwoArray = []
          var thisMonthweekThreeArray = []
          var thisMonthweekFourArray = []
          var thisMonthweekFiveArray = []
          
          var dailyForMauOverDAU = MP.api.query('/api/2.0/events/', {event:events, from:moment().startOf('month'), to:moment(), unit: 'day', union: 1, type:'unique'}, {dataType: 'json'})
          dailyForMauOverDAU.done(function(info){
            console.log(info)
            $.each(info.data.values, function (index, values) {
              thisMonthUniquesbyDayQueryResults.push(values)
            })
            console.log(info.data.series.length)
            for (var i = 0; i < info.data.series.length; i++) {
              if(i <= 6){
                thisMonthweekOneArray.push(parseFloat((thisMonthUniquesbyDayQueryResults[0][info.data.series[i]]/thisMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 7 && i <= 13){
                thisMonthweekTwoArray.push(parseFloat((thisMonthUniquesbyDayQueryResults[0][info.data.series[i]]/thisMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 14 && i <= 20){
                thisMonthweekThreeArray.push(parseFloat((thisMonthUniquesbyDayQueryResults[0][info.data.series[i]]/thisMonthUniques[0]).toFixed(3)*100))
              }else if (i >= 21 && i <= 27) {
                thisMonthweekFourArray.push(parseFloat((thisMonthUniquesbyDayQueryResults[0][info.data.series[i]]/thisMonthUniques[0]).toFixed(3)*100))
              }else if(i >= 28 && i <= 31){
                thisMonthweekFiveArray.push(parseFloat((thisMonthUniquesbyDayQueryResults[0][info.data.series[i]]/thisMonthUniques[0]).toFixed(3)*100))
              }else{}
            }
            console.log(thisMonthUniquesbyDayQueryResults)
            console.log(thisMonthweekOneArray.length)
            console.log(thisMonthweekOneArray)
            console.log(thisMonthweekTwoArray.length)
            console.log(thisMonthweekTwoArray)
            console.log(thisMonthweekThreeArray.length)
            console.log(thisMonthweekThreeArray)
            console.log(thisMonthweekFourArray.length)
            console.log(thisMonthweekFourArray)

            $('#dau-over-mau-graph-2').highcharts({
            title: {
                text: 'DAU\'s over MAU\'s This Month'
            },
            xAxis: {
                categories: ["Day 1", "Day 2", "Day 3","Day 4", "Day 5", "Day 6", "Day 7"]
            },
            yAxis: {
              title: {
                  text: '% DAU over MAU'
              }
            },
            series: [{
                type: 'spline',
                name: 'Week One DAU\'s MAU\'s',
                data: thisMonthweekOneArray
            },{
                type: 'spline',
                name: 'Week Two DAU\'s MAU\'s',
                data: thisMonthweekTwoArray
            },{
                type: 'spline',
                name: 'Week Three DAU\'s MAU\'s',
                data: thisMonthweekThreeArray
            },{
                type: 'spline',
                name: 'Week Four DAU\'s MAU\'s',
                data: thisMonthweekFourArray
            },{
                type: 'spline',
                name: 'Week Five DAU\'s MAU\'s',
                data: thisMonthweekFiveArray
            }],
            exporting: {
              enabled: true
              },
          });
          })
          
        })  
      }


      
      

      //formatting stuff for topbar
      function pad(d) {
          return (d < 10) ? '0' + d.toString() : d.toString();
      }
      function getCurrentMonth(){
          var d = new Date();
          var month = new Array();
          month[0] = "JAN"; 
          month[1] = "FEB";
          month[2] = "MAR";
          month[3] = "APR";
          month[4] = "MAY";
          month[5] = "JUNE";
          month[6] = "JULY";
          month[7] = "AUG";
          month[8] = "SEPT";
          month[9] = "OCT";
          month[10] = "NOV";
          month[11] = "DEC";
          var n = month[d.getMonth()];
          return n;
      }
      function getCurrentDay(){
            var d = new Date();
            var weekday = new Array(7);
            weekday[0]=  "Sunday";
            weekday[1] = "Monday";
            weekday[2] = "Tuesday";
            weekday[3] = "Wednesday";
            weekday[4] = "Thursday";
            weekday[5] = "Friday";
            weekday[6] = "Saturday";
            var n = weekday[d.getDay()];
            return n;
      }
      //end of formatting for topbar

      //refresh top bar
      setInterval(topbarQuery, 2400000);
      
             $('#weeklyNewUsers').highcharts({
          title: {
              text: 'New User Per Week:'
          },
          
          xAxis: {
              categories: weeklyNewUserxAxis
          },
          yAxis: {
            title: {
                text: 'New Users'
            }
          },
          series: [{
              type: 'spline',
              name: 'Weekly New Users',
              data: weeklyNewUseryAxis
          }],
           exporting: {
            enabled: true
          },
        });

       //monthly new users set highcharts graph
        $('#monthlyNewUsers').highcharts({
            title: {
                text: 'New User Per Month'
            },
            xAxis: {
                categories: monthlyNewUserxAxis
            },
            yAxis: {
              title: {
                  text: 'New Users'
              }
            },
            series: [{
                type: 'spline',
                name: 'Monthly New Users',
                data: monthlyNewUserData
            }],
             exporting: {
              enabled: true
            },
        });

        //monthly new over unique users set chart
        $('#monthlyActiveUsers').highcharts({
          title: {
              text: 'Monthly Active Users'
          },
          xAxis: {
              categories: monthlyUniquesXAxis
          },
          yAxis: {
            title: {
                text: 'Active Users'
            }
          },
          series: [{
              type: 'spline',
              name: 'Monthly Acitive Users',
              data: monthlyUniquesYAxis
          }],
           exporting: {
            enabled: true
          },
        });

        //weekly new over unique users set chart
        $('#weeklyActiveUsers').highcharts({
          title: {
              text: 'Weekly Active Users'
          },
          xAxis: {
              categories: weeklyUniquesXAxis
          },
          yAxis: {
            title: {
                text: 'Active Users'
            }
          },
          series: [{
              type: 'spline',
              name: 'Weekly Acitive Users',
              data: weeklyUniquesYAxis
          }],
           exporting: {
            enabled: true
          },
        });

        //monthly dau over mau last month set chart
        $('#dau-over-mau-graph').highcharts({
          title: {
              text: 'DAU\'s over MAU\'s Last Month'
          },
          xAxis: {
              categories: ["Day 1", "Day 2", "Day 3","Day 4", "Day 5", "Day 6", "Day 7"]
          },
          yAxis: {
            title: {
                text: '% DAU over MAU'
            }
          },
          series: [{
              type: 'spline',
              name: 'Week One DAU\'s MAU\'s',
              data: weekOneArray
          },{
              type: 'spline',
              name: 'Week Two DAU\'s MAU\'s',
              data: weekTwoArray
          },{
              type: 'spline',
              name: 'Week Three DAU\'s MAU\'s',
              data: weekThreeArray
          },{
              type: 'spline',
              name: 'Week Four DAU\'s MAU\'s',
              data: weekFourArray
          },{
              type: 'spline',
              name: 'Week Five DAU\'s MAU\'s',
              data: weekFiveArray
          }],
          legend: {
          align: 'center',
          },
          exporting: {
            enabled: true
            },
            });

        //monthly dau over mau this month set chart
        $('#dau-over-mau-graph-2').highcharts({
          title: {
              text: 'DAU\'s over MAU\'s This Month'
          },
          xAxis: {
              categories: ["Day 1", "Day 2", "Day 3","Day 4", "Day 5", "Day 6", "Day 7"]
          },
          yAxis: {
            title: {
                text: '% DAU over MAU'
            }
          },
          series: [{
              type: 'spline',
              name: 'Week One DAU\'s MAU\'s',
              data: thisMonthweekOneArray
          },{
              type: 'spline',
              name: 'Week Two DAU\'s MAU\'s',
              data: thisMonthweekTwoArray
          },{
              type: 'spline',
              name: 'Week Three DAU\'s MAU\'s',
              data: thisMonthweekThreeArray
          },{
              type: 'spline',
              name: 'Week Four DAU\'s MAU\'s',
              data: thisMonthweekFourArray
          },{
              type: 'spline',
              name: 'Week Five DAU\'s MAU\'s',
              data: thisMonthweekFiveArray
          }],
          exporting: {
            enabled: true
            },
        });

        //top events set HighCharts Graph
        $('#graph').highcharts({
          title: {
              text: 'Top Events Over the Last 6 Months: Total Event Counts'
          },
          xAxis: {
              categories: sortedxAxis
          },
          labels: {
              items: [{
                  html: 'Total Event Count For Top Events: Last 6 Months',
                  style: {
                      left: '50px',
                      top: '18px',
                      color: (Highcharts.theme && Highcharts.theme.textColor) || 'black'
                  }
              }]
          },
          series: [{
              type: 'column',
              name: eventsArray[0],
              data: [dataObject[eventsArray[0]][sortedxAxis[0]],dataObject[eventsArray[0]][sortedxAxis[1]],dataObject[eventsArray[0]][sortedxAxis[2]],dataObject[eventsArray[0]][sortedxAxis[3]],dataObject[eventsArray[0]][sortedxAxis[4]],dataObject[eventsArray[0]][sortedxAxis[5]]]
          }, {
              type: 'column',
              name: eventsArray[1],
              data: [dataObject[eventsArray[1]][sortedxAxis[0]],dataObject[eventsArray[1]][sortedxAxis[1]],dataObject[eventsArray[1]][sortedxAxis[2]],dataObject[eventsArray[1]][sortedxAxis[3]],dataObject[eventsArray[1]][sortedxAxis[4]],dataObject[eventsArray[1]][sortedxAxis[5]]]
          }, {
              type: 'column',
              name: eventsArray[2],
              data: [dataObject[eventsArray[2]][sortedxAxis[0]],dataObject[eventsArray[2]][sortedxAxis[1]],dataObject[eventsArray[2]][sortedxAxis[2]],dataObject[eventsArray[2]][sortedxAxis[3]],dataObject[eventsArray[2]][sortedxAxis[4]],dataObject[eventsArray[2]][sortedxAxis[5]]]
          },{
              type: 'column',
              name: eventsArray[3],
              data: [dataObject[eventsArray[3]][sortedxAxis[0]],dataObject[eventsArray[3]][sortedxAxis[1]],dataObject[eventsArray[3]][sortedxAxis[2]],dataObject[eventsArray[3]][sortedxAxis[3]],dataObject[eventsArray[3]][sortedxAxis[4]],dataObject[eventsArray[3]][sortedxAxis[5]]]
          }, {
              type: 'column',
              name: eventsArray[4],
              data: [dataObject[eventsArray[4]][sortedxAxis[0]],dataObject[eventsArray[4]][sortedxAxis[1]],dataObject[eventsArray[4]][sortedxAxis[2]],dataObject[eventsArray[4]][sortedxAxis[3]],dataObject[eventsArray[4]][sortedxAxis[4]],dataObject[eventsArray[4]][sortedxAxis[5]]]
          }, {
              type: 'column',
              name: eventsArray[5],
              data: [dataObject[eventsArray[5]][sortedxAxis[0]],dataObject[eventsArray[5]][sortedxAxis[1]],dataObject[eventsArray[5]][sortedxAxis[2]],dataObject[eventsArray[5]][sortedxAxis[3]],dataObject[eventsArray[5]][sortedxAxis[4]],dataObject[eventsArray[5]][sortedxAxis[5]]]
          }, {
              type: 'spline',
              name: 'Combined Events Average Per Month',
              data: [month1,month2,month3,month4,month5,month6],
              marker: {
                  lineWidth: 2,
                  lineColor: Highcharts.getOptions().colors[3],
                  fillColor: 'white'
              }
          },
          {
              type: 'pie',
              name: 'Total Event Count Last 6 Months',
              data: [{
                  name: eventsArray[0],
                  y: dataObject[eventsArray[0]][sortedxAxis[0]]+dataObject[eventsArray[0]][sortedxAxis[1]]+dataObject[eventsArray[0]][sortedxAxis[2]]+dataObject[eventsArray[0]][sortedxAxis[3]]+dataObject[eventsArray[0]][sortedxAxis[4]]+dataObject[eventsArray[0]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[0] // Jane's color
              }, {
                  name: eventsArray[1],
                  y: dataObject[eventsArray[1]][sortedxAxis[0]]+dataObject[eventsArray[1]][sortedxAxis[1]]+dataObject[eventsArray[1]][sortedxAxis[2]]+dataObject[eventsArray[1]][sortedxAxis[3]]+dataObject[eventsArray[1]][sortedxAxis[4]]+dataObject[eventsArray[1]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[1] // John's color
              }, {
                  name: eventsArray[2],
                  y: dataObject[eventsArray[2]][sortedxAxis[0]]+dataObject[eventsArray[2]][sortedxAxis[1]]+dataObject[eventsArray[2]][sortedxAxis[2]]+dataObject[eventsArray[2]][sortedxAxis[3]]+dataObject[eventsArray[2]][sortedxAxis[4]]+dataObject[eventsArray[2]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[2] // Joe's color
              },{
                  name: eventsArray[3],
                  y: dataObject[eventsArray[3]][sortedxAxis[0]]+dataObject[eventsArray[3]][sortedxAxis[1]]+dataObject[eventsArray[3]][sortedxAxis[2]]+dataObject[eventsArray[3]][sortedxAxis[3]]+dataObject[eventsArray[3]][sortedxAxis[4]]+dataObject[eventsArray[3]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[3] // Joe's color
              },{
                  name: eventsArray[4],
                  y: dataObject[eventsArray[4]][sortedxAxis[0]]+dataObject[eventsArray[4]][sortedxAxis[1]]+dataObject[eventsArray[4]][sortedxAxis[2]]+dataObject[eventsArray[4]][sortedxAxis[3]]+dataObject[eventsArray[4]][sortedxAxis[4]]+dataObject[eventsArray[4]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[4] // Joe's color
              },{
                  name: eventsArray[5],
                  y: dataObject[eventsArray[5]][sortedxAxis[0]]+dataObject[eventsArray[5]][sortedxAxis[1]]+dataObject[eventsArray[5]][sortedxAxis[2]]+dataObject[eventsArray[5]][sortedxAxis[3]]+dataObject[eventsArray[5]][sortedxAxis[4]]+dataObject[eventsArray[5]][sortedxAxis[5]],
                  color: Highcharts.getOptions().colors[5] // Joe's color
              }],
              center: [100, 80],
              size: 60,
              showInLegend: false,
              dataLabels: {
                  enabled: false
              }
          }],
           exporting: {
            enabled: true
          },
           navigation: {
            buttonOptions: {
              align: 'right'
              }
          }
        });
      
      $(document).ready(function () {
        topbarQuery();
        newUsersToday();
        weeklyNewUsersQuery();
        monthlyNewUsersQuery();
        topEventsQuery()
        monthlyQuery()
        weeklyQuery()
        dauOverMausQueryLastMonth()
        dauOverMausQueryThisMonth()
      })
      
    </script>

  </div>
  </body>
</html>

